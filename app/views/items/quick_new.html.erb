<div class="max-w-md mx-auto bg-white shadow-md rounded-lg p-6 mt-8">
  <h1 class="text-xl font-bold text-center mb-4">最初のアイテムを登録しよう!</h1>
  <p class="text-center text-gray-600 mb-6 text-sm">
    画像かタイトルどちらかだけでOK！</p>
  <p class="text-center text-gray-600 mb-6 text-sm">あとで詳しく編集できます。</p>

  <%= form_with model: @item, url: quick_create_items_path, local: true do |f| %>
      <div class="space-y-4 text-sm text-gray-700">
        <%# 画像 %>
        <div>
          <%= f.label :image, '画像（※名前または画像どちらか必須）', class: "block font-medium mb-1" %>
           
          <% if @item.image.attached? %>
  <div class="mb-4">
    <p class="text-sm text-gray-600">現在の画像：</p>
    <% begin %>
      <%= image_tag @item.image.variant(resize_to_limit: [400, 400]).processed,
        class: "mx-auto w-[220px] h-auto max-h-[250px] rounded border object-contain" %>
    <% rescue => e %>
      <p class="text-red-500 text-sm text-center">画像が表示できません（形式が非対応かもしれません）</p>
    <% end %>
  </div>
<% end %>

          <%= f.file_field :image, accept: 'image/*', id: 'image_input', class: "block w-full border border-gray-300 rounded p-2 bg-gray-50" %>
          <p class="text-xs text-gray-500 mt-2 text-center">
            ※ iPhoneで撮影したHEIC形式の画像は、パソコンからは表示できないことがあります。<br>
            表示させたい場合は画像を編集アプリ等で「.jpg」または「.png」形式に変換してください。
          </p>
         <div id="preview_container" class="mt-4 relative w-fit mx-auto">
  <button type="button" id="remove_image_btn"
          class="hidden absolute top-0 right-0 bg-white text-red-600 rounded-full w-6 h-6 text-center shadow hover:bg-red-100 z-10">
    ×
  </button>

  <img id="preview_image" src="#" alt="プレビュー"
       class="hidden w-[220px] h-auto max-h-[250px] rounded border object-contain" />
</div>

    <div class="mb-4">
      <%= f.label :name, "アイテム名（※アイテム名または画像どちらか必須）", class: "block text-gray-700 text-sm mb-1" %>
      <%= f.text_field :name, class: "w-full border rounded p-2" %>
    </div>

    <div class="text-center mt-6">
      <%= f.submit "登録する", class: "bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-md transition" %>
    </div>
  <% end %>
</div>
